node
{
	stage('SCM')
	{
		echo 'Pulling source from Git repo'
		git branch: '${branch}', url:'https://github.com/OneBlueBird/DotNetCoreApps.git'
	}
	stage('Build')
	{
		echo 'Building...'
		sh 'dotnet --version'
		sh 'dotnet build CloudifyConsoleApps.sln'
	}
	stage('Test')
	{
		echo 'Testing...'
	}
	steps('Package')
	{
            dockerBuildAndPublish {
	      repositoryName('virtualbinaries/dotnetcoreapps')
	      tag('${GIT_REVISION,length=9}')
              registryCredentials('dockerhub')
              forcePull(false)
              forceTag(false)
              createFingerprints(false)
              skipDecorate()
            }
        }
	stage('Deploy')
	{
		echo 'Deploying...'
	}
}
